---
title: "PDFs with Typst"
format:
  revealjs:
    title-slide-attributes: 
      data-background-image: ../images/title-slide-light.svg
      data-background-color: "white"
      style: "text-align: right; left: 10%"
---

## Hello, Typst!

![](images/typst-logo.png)

![](images/typst-workflow.png){fig-align="center" width="70%"}

::: notes
Typst is a new open-source markup-based typesetting system that is designed to be as powerful as LaTeX while being much easier to learn and use.
:::

::: footer
Learn more: [Typst in Quarto](https://quarto.org/docs/output-formats/typst.html)
:::

## Hello, Typst!

To use Typst with Quarto, set the format in the YAML of your Quarto document:

:::: {.columns}

::: {.column width="40%"}

```markdown
---
format: typst
---
```

:::


::: {.column width="60%"}

![](images/typst-default-page.png){.border width="50%" fig-align="center" fig-alt="Screenshot of one page of PDF document. The document shows a single column of text." style="box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3); border-radius: 5px;"}

:::
::::

::: footer
Learn more: [Typst in Quarto](https://quarto.org/docs/output-formats/typst.html)
:::

# Building PDFs

## Page layout

Control the size of the page (`papersize`), the page margins (`margin`), and the number of columns used for page content (`columns`):

:::: {.columns}

::: {.column width="40%"}


```markdown
---
title: Page Layout
format:
  typst:
    papersize: a5
    margin:
      x: 1cm
      y: 1cm
    columns: 2
---
``` 

:::

::: {.column width="60%"}

![](images/typst-custom-page.png){.border width="40%" fig-align="center" fig-alt="Screenshot of one page of PDF document. The document shows a two columns of text. Compared to the previous screenshot, the page is narrower and longer, and the margins are smaller." style="box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.3); border-radius: 5px;"}

:::
::::

::: footer
Learn more: [Page Layout](https://quarto.org/docs/output-formats/typst.html#page-layout)
:::

## Margins

Edit the margin's horizontal direction (`x`) and vertical direction (`y`):

```markdown
margin:
  x: 1.25in
  y: 1.25in
```

Can also use relative length:

```markdown
margin:
  left: 10%
```

::: footer
Learn more: [Margins](https://quarto.org/docs/output-formats/typst.html#margins)
:::


## Paper Size

```markdown
papersize: us-letter
```

::: footer
Learn more: [Supported page sizes](https://typst.app/docs/reference/layout/page/#parameters-paper)
:::

## Table of contents

```markdown
toc: true
toc-depth: 2
```

::: footer
Learn more: [Table of Contents](https://quarto.org/docs/output-formats/typst.html#table-of-contents)
:::

## Section numbering

```markdown
number-sections: true
```

Use `number-depth`:

```markdown
number-depth: 3
```

::: footer
Learn more: [Section Numbering](https://quarto.org/docs/output-formats/typst.html#section-numbering)
:::

## Typst blocks

Add a `.block` class to change appearance of blocks:

```markdown
::: {.block fill="luma(230)" inset="8pt" radius="4pt"}

This is a block with gray background and slightly rounded corners.

:::
```

## Your turn

{{< include exercise-01.qmd >}}

# Customizing templates

## Custom Typst formats

Typst allows you to define your own templates to produce highly customized documents.

::: {layout-ncol=4}

![IEEE](images/typst-format-ieee.png){.lightbox group="custom-formats" fig-alt="Screenshot of a page showing a article styled according IEEE standards. The title is centered with authors below in two columns."}

![Poster](images/typst-format-poster.png){.lightbox group="custom-formats" fig-alt="Screenshot of a poster in landscape orientiation. The poster includes a logo in the top right, a title in the top left, and content arranged in three columns."}

![Letter](images/typst-format-letter.png){.lightbox group="custom-formats" fig-alt="Screenshot of a page showing a letter. A sender address is across the top of the page, followed by a recipient address left justified. The body of the letter includes a subject line in bold."}

![Dept News](images/typst-format-dept-news.png){.lightbox group="custom-formats" fig-alt="Screenshot of a page showing a department newsletter. The page is split vertically with a white column on the left and a red one on the right. An image spans across the column with the text \"Award Winning Science\" oriented to run vertically down its right side."}

:::

::: footer
Learn more: [Custom Typst Formats](https://quarto.org/docs/output-formats/typst-custom.html)
:::

## Custom Typst formats {.smaller}

| Format                                                                         | Usage                                                      |
|--------------------------|----------------------------------------------|
| [Poster](https://github.com/quarto-ext/typst-templates/tree/main/poster)       | `quarto use template quarto-ext/typst-templates/poster`    |
| [IEEE](https://github.com/quarto-ext/typst-templates/tree/main/ieee)           | `quarto use template quarto-ext/typst-templates/ieee`      |
| [AMS](https://github.com/quarto-ext/typst-templates/tree/main/ams)             | `quarto use template quarto-ext/typst-templates/ams`       |
| [Letter](https://github.com/quarto-ext/typst-templates/tree/main/letter)       | `quarto use template quarto-ext/typst-templates/letter`    |
| [Fiction](https://github.com/quarto-ext/typst-templates/tree/main/fiction)     | `quarto use template quarto-ext/typst-templates/fiction`   |
| [Dept News](https://github.com/quarto-ext/typst-templates/tree/main/dept-news) | `quarto use template quarto-ext/typst-templates/dept-news` |

::: footer
Learn more: [Custom Typst Formats](https://quarto.org/docs/output-formats/typst-custom.html)
:::

## Creating a new Typst format

Use the `quarto create command` to get started:

``` {.bash filename="Terminal"}
$ quarto create extension format
```

Choose `typst` as the base format and provide a name for the extension.

## Creating a new Typst format {.smaller}

| File                 | Description                                                                                                                                           |
|-------------------------|-----------------------------------------------|
| `_extension.yml`     | Basic extension metadata (name, author, description, etc.) and format definition.                                                                     |
| `README.md`          | Documentation on how to install and use the format.                                                                                                   |
| `template.qmd`       | A starter document that demonstrates the basics of the format.                                                                                        |
| `typst-template.typ` | The core Typst template function (documentation on creating Typst templates can be found here: <https://typst.app/docs/tutorial/making-a-template/>). |
| `typst-show.typ`     | File that calls the template's function (mapping Pandoc metadata to function arguments).                                                              |

## typst-show.typ

```{.markdown filename="typst-show.typ"}
#show: whr.with(
$if(title)$
  title: [$title$],
$endif$
$if(subtitle)$
  subtitle: [$subtitle$],
$endif$
$if(date)$
  date: [$date$],
$endif$
$if(lang)$
  lang: "$lang$",
$endif$
$if(region)$
  region: "$region$",
$endif$
$if(abstract)$
  abstract: [$abstract$],
$endif$
$if(thanks)$
  thanks: [$thanks$],
$endif$
$if(keywords)$
  keywords: ($for(keywords)$"$keywords$",$endfor$),
$endif$
$if(margin)$
  margin: ($for(margin/pairs)$$margin.key$: $margin.value$,$endfor$),
$endif$
$if(papersize)$
  paper: "$papersize$",
$endif$
$if(mainfont)$
  font: ($for(mainfont)$"$mainfont$",$endfor$),
$endif$
$if(fontsize)$
  fontsize: $fontsize$,
$endif$
$if(mathfont)$
  mathfont: ($for(mathfont)$"$mathfont$",$endfor$),
$endif$
$if(codefont)$
  codefont: ($for(codefont)$"$codefont$",$endfor$),
$endif$
$if(toc)$
  toc: $toc$,
$endif$
$if(toc-title)$
  toc_title: [$toc-title$],
$endif$
$if(toc-indent)$
  toc_indent: $toc-indent$,
$endif$
  toc_depth: $toc-depth$,
  cols: $if(columns)$$columns$$else$1$endif$
$if(linkcolor)$
  linkcolor: "$linkcolor$",
$endif$
$if(title-page)$
  title-page: $title-page$,
$endif$
$if(blind)$
  blind: $blind$,
$endif$
)
```

## typst-template.typ

```{.markdown filename="typst-template.typ"}
#let whr-template(
  doc,
  title: none,
  author: none,
  cover_image: none,
  main_logo: none,
  bottom_logos: none,
  toc_background_image: none,
) = {
  // Page setup for the entire document
  set text(font: "Linux Libertine", size: 10pt)
  set heading(numbering: "1.1")
  set page(paper: "a4", margin: (left: 20mm, right: 30mm, top: 20mm, bottom: 20mm))

  // Define the style for purple headings
  show heading: it => {
    set text(fill: rgb("#4B0082")) // A deep purple
    it
  }

  // Define the blue bar on the right side of pages
  #show page: page => {
    // Add the blue bar (except on the cover page)
    if counter(page).at(1) > 1 {
      box(
        width: 10pt,
        height: 100%,
        fill: rgb("#2a87d6"),
        float: true,
        inset: 0pt,
        place(right, top)
      )
    }
    // Render the page content
    page
  }

  // Cover page layout
  page(
    header: none,
    footer: none,
    background: cover_image,
  )[
    #place(
      right, center,
      image(main_logo)
    )

    #if bottom_logos != none {
      #place(bottom, center, [
        #h(1fr) #bottom_logos #h(1fr)
      ])
    }
  ]

  // Table of Contents page
  page(
    header: none,
    footer: none,
    background: toc_background_image,
  )[
    #show: heading.where(level: 1, 2)
    #outline(title: "Contents")
  ]

  // Main content pages
  #set page(columns: 2)
  #set page(
    header: if title != none {
      box(width: 100%, [
        #h(1fr) #text(9pt)[#title]
      ])
    },
    footer: box(
      width: 100%,
      [#h(1fr) #text(9pt)[#counter(page).at(1)]]
    )
  )

  // Insert the main document content
  #doc
}

// Apply the template to the document with the required parameters
#show: doc => whr-template(
  doc,
  title: [WORLD HAPPINESS REPORT 2024],
  cover_image: "../assets/cover-page.jpg",
  main_logo: "../assets/logo-center-right.png",
  bottom_logos: [
    #image("../assets/bottom-logo-1.png", height: 1.5cm)
    #h(1cm)
    #image("../assets/bottom-logo-2.png", height: 1.5cm)
    #h(1cm)
    #image("../assets/bottom-logo-3.png", height: 1.5cm)
  ],
  toc_background_image: "../assets/toc-background.jpg",
)
```